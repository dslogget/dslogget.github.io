<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JUK1: D:/dslog/Documents/JUK1/C++/src/Matlab/vectfit3.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JUK1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('vectfit3_8m_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">vectfit3.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="vectfit3_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a2f86f5e918ad0f898bab438928af0eae">    1</a></span>&#160;<span class="keyword">function</span> [SER,poles,rmserr,fit,opts]=vectfit3(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>,<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>,<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>,weight,opts);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;%</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;%<span class="keyword">function</span> [SER,poles,rmserr,fit,opts]=vectfit3(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>,<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>,<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>,weight,opts)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;%<span class="keyword">function</span> [SER,poles,rmserr,fit]=vectfit3(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>,<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>,<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>,weight,opts)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;%<span class="keyword">function</span> [SER,poles,rmserr,fit]=vectfit3(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>,<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>,<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>,weight)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;% </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;%     ===========================================================</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%     =   Fast Relaxed Vector Fitting                           =</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;%     =   Version 1.0                                           =</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%     =   Last revised: 08.08.2008                              = </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%     =   Written by: Bjorn Gustavsen                           =</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%     =   SINTEF Energy Research, N-7465 Trondheim, NORWAY      =</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;%     =   bjorn.gustavsen@sintef.<a class="code" href="_q_ppassive_8m.html#a7d91f81694976146b3a75aadac28afa0">no</a>                             =</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;%     =   http:<span class="comment">//www.energy.sintef.no/Produkt/VECTFIT/index.asp =</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;%     =   Note: RESTRICTED to NON-COMMERCIAL use                =</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;%     ===========================================================</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;% PURPOSE : Approximate f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) with a state-space model </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;%</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;%         f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>)=C*(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>*I-<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)^(-1)*B +D +s*E</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;%                       </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;%           where f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) is a singe element or a vector of elements.  </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;%           When f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) is a vector, all elements become fitted with a common</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;%           pole set.</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;%</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;% INPUT :</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;%</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;% f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) : function (vector) to be fitted. </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;%        dimension : (Nc,Ns)  </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;%                     Nc : number of elements in vector</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;%                     Ns : number of frequency samples </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;% </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;% s : vector of frequency points [rad/sec] </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;%        dimension : (1,Ns)  </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;%</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;% poles : vector of initial poles [rad/sec]</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;%         dimension : (1,N)  </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;%</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;% weight: the rows in the system matrix are weighted using this array. Can be used </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;%         for achieving higher accuracy at desired frequency samples. </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;%         If no weighting is desired, use unitary weights: weight=ones(1,Ns). </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;%</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;%         Two dimensions are allowed:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;%           dimension : (1,Ns) --&gt; Common weighting for all vector elements.   </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;%           dimension : (Nc,Ns)--&gt; Individual weighting for vector elements.  </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;%</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;% opts.relax==1 --&gt; Use relaxed nontriviality constraint </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;% opts.relax==0 --&gt; Use nontriviality constraint of &quot;standard&quot; vector fitting</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;%</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;% opts.stable=0 --&gt; unstable poles are kept unchanged</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;% opts.stable=1 --&gt; unstable poles are made stable by &#39;flipping&#39; them</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;%                   into the left half-plane</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;% </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;%</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;% opts.asymp=1 --&gt; Fitting with D=0,  E=0 </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;% opts.asymp=2 --&gt; Fitting with D~=0, E=0 </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;% opts.asymp=3 --&gt; Fitting with D~=0, E~=0 </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;%</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;% opts.spy1=1 --&gt; Plotting, after pole identification (<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;%              figure(3): magnitude functions</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;%                cyan trace  : (<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>)fit              </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;%                red trace   : (<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>)fit</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;%                green trace : f*(<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>)fit - (<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>)fit</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;%</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;% opts.spy2=1 --&gt; Plotting, after residue identification (C,<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>,E) </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;%              figure(1): magnitude functions</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;%              figure(2): phase angles  </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;%</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;% opts.logx=1 --&gt; Plotting using logarithmic absissa axis             </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;%</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;% opts.logy=1 --&gt; Plotting using logarithmic ordinate axis</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;%</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;% opts.errplot=1   --&gt; Include deviation in magnitude plot</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;%</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;% opts.phaseplot=1 --&gt;Show plot also for phase angle</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;%</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;%</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;% opts.skip_pole=1 --&gt; The pole identification part is skipped, i.e (C,<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>,E) </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;%                    are identified using the initial poles (<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>) as final poles.</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;%                 </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;% opts.skip_res =1 --&gt; The residue identification part is skipped, i.e. only the </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;%                    poles (<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>) are identified while C,D,E are returned as zero. </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;%</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;%</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;% opts.cmplx_ss  =1 --&gt;The returned state-space model has real and complex conjugate </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;%                    parameters. Output variable A is diagonal (and sparse). </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;%              =0 --&gt;The returned state-space model has real parameters only.</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;%                    Output variable A is square with 2x2 blocks (and sparse).</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;%</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;% OUTPUT :</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;% </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;%     fit(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) = C*(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>*I-(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)^(-1)*B +D +s.*E</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;%</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;% SER.A(N,N)    : A-matrix (sparse). If cmplx_ss==1: Diagonal and complex. </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;%                                Otherwise, square and real with 2x2 blocks. </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;%                           </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;% SER.B(N,1)    : B-matrix. If cmplx_ss=1: Column of 1&#39;s. </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;%                       If cmplx_ss=0: contains 0&#39;s, 1&#39;s and 2&#39;s)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;% SER.C(Nc,N)   : C-matrix. If cmplx_ss=1: complex</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;%                       If cmplx_ss=0: real-only</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;% SERD.D(Nc,1)  : constant term (real). Is non-zero if asymp=2 or 3.</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;% SERE.E(Nc,1)  : proportional term (real). Is non-zero if asymp=3.</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;%</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;% poles(1,N)    : new poles </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;%</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;% rmserr(1) : root-mean-square error of approximation for f(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>). </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;%                   (0 is returned if <a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>==1)  </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;% fit(Nc,Ns): Rational approximation at samples. (0 is returned if</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;%             <a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>==1).</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;%</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;%</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;% APPROACH: </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;% The identification is done using the pole relocating method known as Vector Fitting [1], </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;% with relaxed non-triviality constraint for faster convergence and smaller fitting errors [2], </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;% and utilization of matrix structure for fast solution of the pole identifion step [3]. </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;%</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;%******************************************************************************** </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;% NOTE: The use of this program is limited to NON-COMMERCIAL usage only.</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;% If the program code (or <a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a> modified version) is used in a scientific work, </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;% then reference should be made to the following:  </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;%</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;% [1] B. Gustavsen and A. Semlyen, &quot;Rational approximation of frequency       </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;%     domain responses by Vector Fitting&quot;, IEEE Trans. Power Delivery,        </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;%     vol. 14, no. 3, pp. 1052-1061, July 1999.                                </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;%</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;% [2] B. Gustavsen, &quot;Improving the pole relocating properties of vector</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;%     fitting&quot;, IEEE Trans. Power Delivery, vol. 21, no. 3, pp. 1587-1592,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;%     July 2006.   </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;%</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;% [3] D. Deschrijver, M. Mrozowski, T. Dhaene, and D. De Zutter,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;%     &quot;Macromodeling of Multiport Systems Using a Fast Implementation of</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;%     the Vector Fitting Method&quot;, IEEE Microwave and Wireless Components </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">  133</a></span>&#160;%     Letters, vol. 18, no. 6, pp. 383-385, June 2008.</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;%********************************************************************************</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">  135</a></span>&#160;% This example script is part of the vector fitting package (VFIT3.zip) </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;% Last revised: 08.08.2008. </div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#ac0e19213c1ea9a512fea6f185c6f4573">  137</a></span>&#160;% Created by:   Bjorn Gustavsen.</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;%</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a2d6365ba9c4986ccd25d2a6255aaa975">  139</a></span>&#160;% </div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">  140</a></span>&#160;def.relax=1;      %Use vector <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a> with relaxed non-triviality constraint</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;def.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>=1;     %Enforce <a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a> <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a></div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">  142</a></span>&#160;def.asymp=2;      %Include only <a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a> in <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a> (not E)   </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">  143</a></span>&#160;def.skip_pole=0;  %Do NOT skip pole identification</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">  144</a></span>&#160;def.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>=0;   %Do NOT skip identification of <a class="code" href="vectfit3_8m.html#ac0e19213c1ea9a512fea6f185c6f4573">residues</a> (C,<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>,E) </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;def.cmplx_ss=1;   %Create complex state space model</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;def.<a class="code" href="vectfit3_8m.html#a2d6365ba9c4986ccd25d2a6255aaa975">spy1</a>=0;       %No plotting for first stage of vector <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;def.<a class="code" href="vectfit3_8m.html#a1fa4192670bf44f6f0a620b55b725635">spy2</a>=1;       %Create magnitude <a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a> for <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a> of <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>) </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;def.logx=1;       %Use logarithmic abscissa axis</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;def.<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=1;       %Use logarithmic ordinate axis </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;def.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>=1;    %Include deviation in magnitude <a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;def.<a class="code" href="vectfit3_8m.html#ac31e858b1752c374e24ca249b311a362">phaseplot</a>=0;  %exclude <a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a> of phase <a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a> (in addition to magnitiude)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;def.legend=1;     %Do include legends in plots</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;if nargin&lt;5</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  opts=def;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;else </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  %Merge default values into opts  </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=fieldnames(def);    </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    if ~isfield(opts,<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      dum=<span class="keywordtype">char</span>(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)); dum2=getfield(def,dum); opts=setfield(opts,dum,dum2);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    end</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  end  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;end </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;%Tolerances used by relaxed version of vector <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;TOLlow=1e-18; TOLhigh=1e18;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;[<a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>,<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>]=size(<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>); </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;if <a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>(1)==0 &amp;&amp; <a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>==1</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  if <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(1)==0 &amp;&amp; <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(2)~=0 </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(1)=-1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  elseif <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(2)==0 &amp;&amp; <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(1)~=0 </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(2)=-1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  elseif <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(1)==0 &amp;&amp; <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(2)==0 </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(1)=-1+<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*10; <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>(2)=-1-<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*10;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  end</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;end  </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;if (opts.relax~=0) &amp;&amp; (opts.relax)~=1</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.relax:  &#39; num2str(opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>)]),return</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;end</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;if (opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>~=1) &amp;&amp; (opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>)~=2 &amp;&amp; (opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>)~=3</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>:  &#39; num2str(opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>)]),return</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;end</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;if (opts.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>~=0) &amp;&amp; (opts.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>~=1) </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>:  &#39; num2str(opts.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>)]),return</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;end</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;if (opts.skip_pole~=0) &amp;&amp; (opts.skip_pole)~=1</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.skip_pole:  &#39; num2str(opts.skip_pole)]),return</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;end</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;if (opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>~=0) &amp;&amp; (opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>)~=1</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>:  &#39; num2str(opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>)]),return</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;end</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;if (opts.cmplx_ss~=0) &amp;&amp; (opts.cmplx_ss)~=1</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>([&#39;    ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: ==&gt; Illegal value for opts.cmplx_ss:  &#39; num2str(opts.cmplx_ss)]),return</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;end</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;rmserr=[];%SERC=[];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;[<a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>,<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>]=size(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;if <a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>&lt;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>, <a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>=<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>.&#39;; end </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;% Some sanity checks <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a> dimension of input arrays:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;if length(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>)~=length(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(1,:))</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>(&#39;Error in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>!!! ==&gt; Second dimension of <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a> does not match length of <a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>.&#39;); </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  return;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;end  </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;if length(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>)~=length(weight(1,:))</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>(&#39;Error in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>!!! ==&gt; Second dimension of weight does not match length of <a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>.&#39;);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  return;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;end</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;if length(weight(:,1))~=1</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  if length(weight(:,1))~=length(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(:,1))</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>(&#39;Error in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>!!! ==&gt; First dimension of weight is neither 1 nor matches first dimension of <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>.&#39;);  </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    return;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  end</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;end  </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  %<a class="code" href="_freq_8m.html#ac942409636bb3e8c820ec266573990a2">set</a>(0,&#39;DefaultLineLineWidth&#39;,0.5) ; <a class="code" href="_freq_8m.html#ac942409636bb3e8c820ec266573990a2">set</a>(0,&#39;DefaultLineMarkerSize&#39;,4) ;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  %clear <a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>; clear C; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  LAMBD=diag(<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  Ns=length(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>); N=length(LAMBD); Nc=length(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(:,1));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  B=ones(N,1); %I=diag(ones(1,N));                </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  SERA=<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>;SERC=zeros(Nc,N);SERD=zeros(Nc,1);SERE=zeros(Nc,1);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  roetter=<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  fit=zeros(Nc,Ns);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  weight=weight.&#39;;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  if length(weight(1,:))==1</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    common_weight=1;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  elseif length(weight(1,:))==Nc</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    common_weight=0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  else</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a>(&#39;ERROR in vectfit3.<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>: Invalid size of array weight&#39;)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    return</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  end</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==1</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    offs=0; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    offs=1;  </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  else</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    offs=2; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  end</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;%  POLE IDENTIFICATION:</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;if opts.skip_pole~=1  </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;Escale=zeros(1,Nc+1);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;%=======================================================</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;% Finding out which starting <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a> are complex :</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;%=======================================================</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;cindex=zeros(1,N);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  if imag(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))~=0  </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    if <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>==1 </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    else</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==0 || cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==2</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1; cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=2; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      else</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=2;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      end</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    end </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  end</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;end</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;%=======================================================</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;% Building system - <a class="code" href="find_complex_rational_approximation_8m.html#abe2340411a23afe1be8f0a486a4c92f1">matrix</a> :</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;%=======================================================</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; %I3=diag(ones(1,Nc));I3(:,Nc)=[]; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  Dk=zeros(Ns,N);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==0      %real pole</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    elseif cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1  %complex pole, 1st part</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)  =1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) + 1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) - <a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    end</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  end      </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==1 || opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   Dk(:,N+1)=1; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3   </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   Dk(:,N+1)=1; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   Dk(:,N+2)=<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; end</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;%Scaling for last row of LS-problem (pole identification)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>=0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:Nc</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  if length(weight(1,:))==1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>=<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>+(norm(weight(:,1).*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,:).&#39;))^2;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  else</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>=<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>+(norm(weight(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>).*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,:).&#39;))^2;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  end  </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;end</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>=sqrt(<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>)/Ns; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;if opts.relax==1   </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  %Escale=zeros(1,Nc*(N+offs)+N+1);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  %<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>=norm(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>);%/Ns; %Scaling for <a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a> in LS problem </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  AA=zeros(Nc*(N+1),N+1);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  bb=zeros(Nc*(N+1),1);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  Escale=zeros(1,length(AA(1,:)));</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  for n=1:Nc</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=zeros(Ns,(N+offs) +N+1); %<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>=zeros(Ns*Nc+1,1);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    if common_weight==1</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      weig=weight;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    else</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      weig=weight(:,n);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    end </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N+offs %left block</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=weig.*Dk(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    end</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    inda=N+offs;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N+1 %right block</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,inda+<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=-weig.*Dk(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>).*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(n,1:Ns).&#39;;    </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    end</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;     </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=[real(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>);imag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)];</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    %Integral criterion for <a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>:</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="_freq_8m.html#a7a229a4786deeddd59c6091247a8c8a6">offset</a>=(N+offs);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    if n==Nc</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      for mm=1:N+1  </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(2*Ns+1,<a class="code" href="_freq_8m.html#a7a229a4786deeddd59c6091247a8c8a6">offset</a>+mm)=real(<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>*<a class="code" href="rot_8m.html#a08a8fae29827bd080fd336a8b6ba58c6">sum</a>(Dk(:,mm)));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      end</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    end  </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    [Q,R]=qr(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>,0);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    ind1=N+offs+1;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    ind2=N+offs+N+1;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    R22=R(ind1:ind2,ind1:ind2);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    AA((n-1)*(N+1)+1:n*(N+1),:)=R22;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    if n==Nc</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      bb((n-1)*(N+1)+1:n*(N+1),1)=Q(end,N+offs+1:end)&#39;*Ns*<a class="code" href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a>; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    end</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  end %for n=1:Nc </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  for col=1:length(AA(1,:))</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    Escale(col)=1/norm(AA(:,col));  </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    AA(:,col)=Escale(col).*AA(:,col);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  end  </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=AA\bb;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  %size(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>),size(Escale)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>.*Escale.&#39;;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;end %if opts.relax==0   </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;%Situation: No relaxation, or produced <a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a> of <a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a> extremely small and large. Solve again, without relaxation </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  if opts.relax==0 | <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&lt;TOLlow | <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&gt;TOLhigh</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    AA=zeros(Nc*(N),N);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    bb=zeros(Nc*(N),1);   </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    if opts.relax==0</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      Dnew=1; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    else</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      if <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end)==0</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        Dnew=1;      </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      elseif <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&lt;TOLlow</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        Dnew=sign(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))*TOLlow</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      elseif <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&gt;TOLhigh </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        Dnew=sign(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))*TOLhigh   </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      end    </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    end</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   for n=1:Nc</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=zeros(Ns,(N+offs) +N); %<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>=zeros(Ns*Nc+1,1);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      Escale=zeros(1,N);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      if common_weight==1</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        weig=weight;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      else</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        weig=weight(:,n);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      end </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N+offs %left block</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=weig.*Dk(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      end</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      inda=N+offs;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N %right block</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,inda+<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=-weig.*Dk(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>).*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(n,1:Ns).&#39;;    </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      end</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>=Dnew*weig.*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(n,1:Ns).&#39;;     </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=[real(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>);imag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>)];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>=[real(<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>);imag(<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>)];       </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="_freq_8m.html#a7a229a4786deeddd59c6091247a8c8a6">offset</a>=(N+offs);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      [Q,R]=qr(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>,0);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      ind1=N+offs+1;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      ind2=N+offs+N;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      R22=R(ind1:ind2,ind1:ind2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      AA((n-1)*N+1:n*N,:)=R22;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      bb((n-1)*N+1:n*N,1)=Q(:,ind1:ind2).&#39;*<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    end %for n=1:Nc </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    for col=1:length(AA(1,:))</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      Escale(col)=1./norm(AA(:,col));  </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      AA(:,col)=Escale(col).*AA(:,col);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    end  </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    %if opts.use_normal==1 </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    %  <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=AA.&#39;*AA\(AA.&#39;*bb);  </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    %else     </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=AA\bb;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    %end </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>.*Escale.&#39;;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=[<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>;Dnew];</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  end  %if opts.relax==0 | <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&lt;TOLlow | <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end))&gt;TOLhigh</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  %************************************  </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;C=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(1:end-1);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(end); %NEW!!</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;%We now change back to <a class="code" href="get_residues_8m.html#ad09d5e2b38260605147c2f55bdacc7db">make</a> C complex : </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;% **************</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    for n=1:1%Nc+1</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      r1=C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>); r2=C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=r1+<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*r2; C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=r1-<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*r2;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    end</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  end</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;end</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;% **************  </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a2d6365ba9c4986ccd25d2a6255aaa975">spy1</a>==1</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  Dk=zeros(Ns,N); </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  end </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  RES3(:,1)=<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>+Dk*C; % (<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>)rat</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>=<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>./(2*<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>*<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>); </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  if opts.logx==1  </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>==1</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3),</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      h1=loglog(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(RES3&#39;),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);  %<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    else %<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=0</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3),</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      h1=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(RES3&#39;),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    end</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  else %logx=0</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>==1</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      h1=semilogy(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(RES3&#39;),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    else %<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=0</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      h1=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>./(2*<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>*<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>),<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(RES3&#39;),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    end</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  end</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3),xlabel(&#39;Frequency [Hz]&#39;); ylabel(&#39;Magnitude&#39;); </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  %<a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(3), <a class="code" href="transistor_comparison_8m.html#ab17c3cef3d14df451e925a524b5d9106">title</a>(&#39;Sigma&#39;)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  if opts.legend==1</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    legend([h1(1)],&#39;<a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a>&#39;);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  end  </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  drawnow;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;end</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;%=============================================================================</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;% We now calculate the zeros for <a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a> :</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;%=============================================================================</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;%oldLAMBD=LAMBD;oldB=B;oldC=C;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=0;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;for n=1:N</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  if <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>&lt;N  </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    if( <a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))&gt;<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(real(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))) ) %complex number?</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=-imag(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)); LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=imag(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=real(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      B(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,1)=2; B(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1,1)=0; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      koko=C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>); C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=real(koko); C(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=imag(koko);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    end</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  end</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;end</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;ZER=LAMBD-B*C.&#39;/<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;roetter=eig(ZER).&#39;;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;unstables=real(roetter)&gt;0;  </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>==1</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  roetter(unstables)=roetter(unstables)-2*real(roetter(unstables)); %Forcing unstable <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a> to be <a class="code" href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a>...</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;end</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;roetter=sort(roetter); N=length(roetter);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;%=============================================</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;%Sorterer polene <a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>.<a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>. de reelle kommer frst:</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;for n=1:N</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=n+1:N</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    if imag(roetter(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))==0 &amp;&amp; imag(roetter(n))~=0</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      trans=roetter(n); roetter(n)=roetter(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>); roetter(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=trans;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    end</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  end</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;end</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;N1=0;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  if imag(roetter(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))==0, N1=<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>; end</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;end</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;if N1&lt;N, roetter(N1+1:N)=sort(roetter(N1+1:N)); end   % N1: n.o. real <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;%N2=N-N1;                                             % N2: n.o. imag.<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;roetter=roetter-2*<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*imag(roetter); %10.11.97 !!!</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;SERA=roetter.&#39;;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;end %if skip_pole~=1  </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;%  RESIDUE IDENTIFICATION:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>~=1</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;%=============================================================================</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;% We now calculate SER for <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>, using the modified zeros of <a class="code" href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a> as new <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a> :</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;%========================================================================================</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;%clear LAMBD <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a> A1 xA1 xxA1 A2 xA2 xxA2 <a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a> xb xxb C RES1 RES2;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;LAMBD=roetter; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;%B=ones(N,1); </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;% Finding out which <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a> are complex :</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;cindex=zeros(1,N);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  if imag(LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))~=0  </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    if <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>==1 </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    else</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==0 || cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==2</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1; cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=2; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      else</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=2;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      end</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    end </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  end</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;end</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;%===============================================================================</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;% We now calculate the SER for <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a> (new <a class="code" href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a>), using the above calculated </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;% zeros as known <a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a> :</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;%=============================================================================== </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==1</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=zeros(2*Ns,N); BB=zeros(2*Ns,Nc);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=zeros(2*Ns,N+1); BB=zeros(2*Ns,Nc);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;else</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=zeros(2*Ns,N+2); BB=zeros(2*Ns,Nc);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;end</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; %I3=diag(ones(1,Nc));I3(:,Nc)=[]; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  Dk=zeros(Ns,N); </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==0      %real pole</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      elseif cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1  %complex pole, 1st part</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)  =1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) + 1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) - <a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      end</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    end </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;if common_weight==1</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; %I3=diag(ones(1,Nc));I3(:,Nc)=[]; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  Dk=zeros(Ns,N); </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==0      %real pole</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=weight./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      elseif cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1  %complex pole, 1st part</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)  =weight./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) + weight./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>.*weight./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)) - <a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>.*weight./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-LAMBD(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)&#39;);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      end</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    end </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==1</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=weight;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  else</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=weight; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+2)=weight.*<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  end</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:Nc</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    BB(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=weight.*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,:).&#39;;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  end</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,:)=imag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:));</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:)=real(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:));</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  BB(Ns+1:2*Ns,:)=imag(BB(1:Ns,:));</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  BB(1:Ns,:)=real(BB(1:Ns,:));</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1);             </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1);             </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,N+2)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,N+2);  </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  end</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  %clear Escale;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  Escale=zeros(1,length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1,:)));</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  for col=1:length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1,:));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    Escale(col)=norm(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col),2);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col)./Escale(col);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  end</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  X=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>\BB;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  for n=1:Nc</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    X(:,n)=X(:,n)./Escale.&#39;;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  end</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  %clear <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  X=X.&#39;;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  C=X(:,1:N); </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    SERD=X(:,N+1);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    SERE=X(:,N+2); </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    SERD=X(:,N+1);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  end</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;else %if common_weight==1</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  SERD=zeros(Nc,1); </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  SERE=zeros(Nc,1); </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  C=zeros(Nc,N);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  for n=1:Nc</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==1</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=1;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    else</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,1:N)=Dk; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=1; <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+2)=<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    end</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1,:))</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=weight(:,n).*<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    end</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    BB=weight(:,n).*<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>(n,:).&#39;;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,:)=imag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:));</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:)=real(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,:));</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    BB(Ns+1:2*Ns)=imag(BB(1:Ns));</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    BB(1:Ns)=real(BB(1:Ns));</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1);             </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1:Ns,N+1);             </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,N+2)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(Ns+1:2*Ns,N+2);  </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    end</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    %clear Escale;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    Escale=zeros(1,length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1,:)));</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    for col=1:length(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(1,:));</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      Escale(col)=norm(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col),2);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col)=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(:,col)./Escale(col);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    end</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>\BB;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>./Escale.&#39;;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    %clear <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    C(n,1:N)=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(1:N).&#39;; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      SERD(n)=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(N+1);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      SERE(n)=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(N+2); </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      SERD(n)=<a class="code" href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a>(N+1);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    end</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  end %for n=1:Nc</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;end %if common_weight==1    </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;%=========================================================================</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;%We now change back to <a class="code" href="get_residues_8m.html#ad09d5e2b38260605147c2f55bdacc7db">make</a> C complex. </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    for n=1:Nc</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      r1=C(n,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>); r2=C(n,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      C(n,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=r1+<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*r2; C(n,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=r1-<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>*r2;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   end</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  end</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;end</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;% **************  </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;B=ones(N,1);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;%====================================================</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;SERA  = LAMBD;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;SERB  = B;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;SERC  = C;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  Dk=zeros(Ns,N); </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    Dk(:,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1./(<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>-SERA(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>));</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  end </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  for n=1:Nc</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    fit(n,:)=(Dk*SERC(n,:).&#39;).&#39;;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==2</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      fit(n,:)=fit(n,:)+SERD(n);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    elseif opts.<a class="code" href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a>==3</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      fit(n,:)=fit(n,:)+SERD(n)+<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>.&#39;.*SERE(n);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    end</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  end </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  fit=fit.&#39;; <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>=<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>.&#39;;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  diff=fit-<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>; rmserr=sqrt(<a class="code" href="rot_8m.html#a08a8fae29827bd080fd336a8b6ba58c6">sum</a>(<a class="code" href="rot_8m.html#a08a8fae29827bd080fd336a8b6ba58c6">sum</a>(<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(diff.^2))))/sqrt(Nc*Ns);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a1fa4192670bf44f6f0a620b55b725635">spy2</a>==1</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>=<a class="code" href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a>./(2*<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>*<a class="code" href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  if opts.logx==1     </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>==1</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(1),</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      h1=loglog(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      h2=loglog(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(fit),&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;); hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      if opts.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>== 1</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a>,h3=loglog(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>-fit),&#39;g&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a>; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      end</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    else %<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=0 </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(1),</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      h1=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      h2=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(fit),&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;); hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      if opts.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>== 1</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a>,h3=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>-fit),&#39;g&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a>; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      end</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    end</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#ac31e858b1752c374e24ca249b311a362">phaseplot</a>==1</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(2),</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      h4=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,180*unwrap(<a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>))/<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>,&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      h5=semilogx(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,180*unwrap(<a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a>(fit))/<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>,&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    end  </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  else %logx=0</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>==1</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(1),</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      h1=semilogy(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      h2=semilogy(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(fit),&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;); hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      if opts.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>== 1</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a>,h3=semilogy(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>-fit),&#39;g&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a>; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      end</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    else %<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=0 </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(1), </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      h1=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>),&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      h2=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(fit),&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;); hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      if opts.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>== 1</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a>,h3=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,<a class="code" href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>-fit),&#39;g&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a>; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      end</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    end</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#ac31e858b1752c374e24ca249b311a362">phaseplot</a>==1    </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(2),</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      h4=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,180*unwrap(<a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a>(<a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>))/<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>,&#39;<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>&#39;); xlim([<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(1) <a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>(Ns)]);hold <a class="code" href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      h5=<a class="code" href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a>(<a class="code" href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a>,180*unwrap(<a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a>(fit))/<a class="code" href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a>,&#39;<a class="code" href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a>--&#39;);hold <a class="code" href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    end  </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  end %<a class="code" href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a>=0</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(1),</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  xlabel(&#39;Frequency [Hz]&#39;); ylabel(&#39;Magnitude&#39;);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  %<a class="code" href="transistor_comparison_8m.html#ab17c3cef3d14df451e925a524b5d9106">title</a>(&#39;Approximation of <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>&#39;);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  if opts.legend==1</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    if opts.<a class="code" href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a>==1</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      legend([h1(1) h2(1) h3(1)],&#39;Data&#39;,&#39;FRVF&#39;,&#39;Deviation&#39;);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    else</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      legend([h1(1) h2(1)],&#39;Data&#39;,&#39;FRVF&#39;);       </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    end  </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  end</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  if opts.<a class="code" href="vectfit3_8m.html#ac31e858b1752c374e24ca249b311a362">phaseplot</a>==1</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a>(2),</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    xlabel(&#39;Frequency [Hz]&#39;); ylabel(&#39;Phase <a class="code" href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a> [deg]&#39;);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    %<a class="code" href="transistor_comparison_8m.html#ab17c3cef3d14df451e925a524b5d9106">title</a>(&#39;Approximation of <a class="code" href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a>&#39;);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    if opts.legend==1</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      legend([h4(1) h5(1)],&#39;Data&#39;,&#39;FRVF&#39;); </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    end</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  end</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  drawnow;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;end</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;fit=fit.&#39;;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;end %if <a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>~=1</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=SERA;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<a class="code" href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a>=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;if opts.<a class="code" href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a>~=1</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  B=SERB; C=SERC; <a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>=SERD; E=SERE;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;else</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  B=ones(N,1); C=zeros(Nc,N); <a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>=zeros(Nc,Nc); E=zeros(Nc,Nc); rmserr=0;  </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;end;    </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;%========================================</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;% Convert into real state-space model</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;%========================================</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;if opts.cmplx_ss~=1 </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=diag(sparse(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>));</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  cindex=zeros(1,N);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    if imag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>,<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>))~=0  </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      if <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>==1 </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      else</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==0 || cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>-1)==2</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=1; cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>+1)=2; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        else</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)=2;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        end</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      end </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    end</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  end</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  n=0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  for <a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>=1:N</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    n=n+1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    if cindex(<a class="code" href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a>)==1</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(n,n); a1=real(<a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>); a2=imag(<a class="code" href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      c=C(:,n); c1=real(c); c2=imag(c);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>=B(n,:); b1=2*real(<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>); b2=-2*imag(<a class="code" href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      Ablock=[a1 a2;-a2 a1];</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>(n:n+1,n:n+1)=Ablock;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      C(:,n)=c1;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      C(:,n+1)=c2;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      B(n,:)=b1;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      B(n+1,:)=b2;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    end</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  end</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;else</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=sparse(diag(<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>));    % <a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a> is complex, <a class="code" href="get_residues_8m.html#ad09d5e2b38260605147c2f55bdacc7db">make</a> it diagonal</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;end %if cmplx_ss~=1    </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;SER.<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>=<a class="code" href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a>; SER.B=B; SER.C=C; SER.<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>=<a class="code" href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a>; SER.E=E;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="ttc" id="a_freq_8m_html_a16d5d24f5b09a1991bd4e5f57bf11237"><div class="ttname"><a href="_freq_8m.html#a16d5d24f5b09a1991bd4e5f57bf11237">pi</a></div><div class="ttdeci">pi</div><div class="ttdef"><b>Definition:</b> <a href="_freq_8m_source.html#l00024">Freq.m:24</a></div></div>
<div class="ttc" id="a_freq_8m_html_a7a229a4786deeddd59c6091247a8c8a6"><div class="ttname"><a href="_freq_8m.html#a7a229a4786deeddd59c6091247a8c8a6">offset</a></div><div class="ttdeci">offset</div><div class="ttdef"><b>Definition:</b> <a href="_freq_8m_source.html#l00002">Freq.m:2</a></div></div>
<div class="ttc" id="a_freq_8m_html_ac942409636bb3e8c820ec266573990a2"><div class="ttname"><a href="_freq_8m.html#ac942409636bb3e8c820ec266573990a2">set</a></div><div class="ttdeci">set(gca, 'YScale', 'log')</div></div>
<div class="ttc" id="a_q_ppassive_8m_html_a09bb415406bbe2b23e379317002b1dba"><div class="ttname"><a href="_q_ppassive_8m.html#a09bb415406bbe2b23e379317002b1dba">freq</a></div><div class="ttdeci">PURPOSE j at all freq</div><div class="ttdef"><b>Definition:</b> <a href="_q_ppassive_8m_source.html#l00043">QPpassive.m:44</a></div></div>
<div class="ttc" id="a_q_ppassive_8m_html_a4792de30be16d1aed1a1665418e67c9a"><div class="ttname"><a href="_q_ppassive_8m.html#a4792de30be16d1aed1a1665418e67c9a">D</a></div><div class="ttdeci">PURPOSE j D</div><div class="ttdef"><b>Definition:</b> <a href="_q_ppassive_8m_source.html#l00029">QPpassive.m:30</a></div></div>
<div class="ttc" id="a_q_ppassive_8m_html_a7d91f81694976146b3a75aadac28afa0"><div class="ttname"><a href="_q_ppassive_8m.html#a7d91f81694976146b3a75aadac28afa0">no</a></div><div class="ttdeci">common weighting for all matrix elements relative to the total weighting of samples in the fitting range Is only used if then reference should be made to the Enforcing Passivity for Admittance Matrices *Approximated by Rational IEEE Trans Power no</div><div class="ttdef"><b>Definition:</b> <a href="_q_ppassive_8m_source.html#l00081">QPpassive.m:81</a></div></div>
<div class="ttc" id="a_q_ppassive_8m_html_ab20e317c6d731cc3115f2630675017be"><div class="ttname"><a href="_q_ppassive_8m.html#ab20e317c6d731cc3115f2630675017be">m</a></div><div class="ttdeci">PURPOSE j m</div><div class="ttdef"><b>Definition:</b> <a href="_q_ppassive_8m_source.html#l00021">QPpassive.m:21</a></div></div>
<div class="ttc" id="acomp_8m_html_a119afed74ed106073a4a6d30c54c4c1d"><div class="ttname"><a href="comp_8m.html#a119afed74ed106073a4a6d30c54c4c1d">plot</a></div><div class="ttdeci">plot(d.time, d.(nodeNum))</div></div>
<div class="ttc" id="acomp_8m_html_a58ab1fd68e97078232808206b850161b"><div class="ttname"><a href="comp_8m.html#a58ab1fd68e97078232808206b850161b">on</a></div><div class="ttdeci">hold on</div><div class="ttdef"><b>Definition:</b> <a href="comp_8m_source.html#l00011">comp.m:11</a></div></div>
<div class="ttc" id="acomp_8m_html_a835accca41274fb237599d9b3c117fcf"><div class="ttname"><a href="comp_8m.html#a835accca41274fb237599d9b3c117fcf">off</a></div><div class="ttdeci">hold off</div><div class="ttdef"><b>Definition:</b> <a href="comp_8m_source.html#l00012">comp.m:12</a></div></div>
<div class="ttc" id="acomp_8m_html_aff7b2de34a3b40f8e7649c2b9e357843"><div class="ttname"><a href="comp_8m.html#aff7b2de34a3b40f8e7649c2b9e357843">figure</a></div><div class="ttdeci">end figure()</div></div>
<div class="ttc" id="afind_complex_rational_approximation_8m_html_a514f1b439f404f86f77090fa9edc96ce"><div class="ttname"><a href="find_complex_rational_approximation_8m.html#a514f1b439f404f86f77090fa9edc96ce">r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> <a href="find_complex_rational_approximation_8m_source.html#l00055">findComplexRationalApproximation.m:55</a></div></div>
<div class="ttc" id="afind_complex_rational_approximation_8m_html_a941bc79a8e80f2d30662d054fb5648f7"><div class="ttname"><a href="find_complex_rational_approximation_8m.html#a941bc79a8e80f2d30662d054fb5648f7">poles</a></div><div class="ttdeci">Undo scaling of outgoing poles</div><div class="ttdef"><b>Definition:</b> <a href="find_complex_rational_approximation_8m_source.html#l00070">findComplexRationalApproximation.m:70</a></div></div>
<div class="ttc" id="afind_complex_rational_approximation_8m_html_abc1de55a1ded540ae925d455d78d4573"><div class="ttname"><a href="find_complex_rational_approximation_8m.html#abc1de55a1ded540ae925d455d78d4573">sigma</a></div><div class="ttdeci">sigma</div><div class="ttdef"><b>Definition:</b> <a href="find_complex_rational_approximation_8m_source.html#l00016">findComplexRationalApproximation.m:16</a></div></div>
<div class="ttc" id="afind_complex_rational_approximation_8m_html_abe2340411a23afe1be8f0a486a4c92f1"><div class="ttname"><a href="find_complex_rational_approximation_8m.html#abe2340411a23afe1be8f0a486a4c92f1">matrix</a></div><div class="ttdeci">Turn this into a matrix</div><div class="ttdef"><b>Definition:</b> <a href="find_complex_rational_approximation_8m_source.html#l00025">findComplexRationalApproximation.m:25</a></div></div>
<div class="ttc" id="afind_complex_rational_approximation_8m_html_ace5ae57a640fd6f3b4e6ed038aac371f"><div class="ttname"><a href="find_complex_rational_approximation_8m.html#ace5ae57a640fd6f3b4e6ed038aac371f">s</a></div><div class="ttdeci">Turn this into a with identical frequencies along the rows s</div><div class="ttdef"><b>Definition:</b> <a href="find_complex_rational_approximation_8m_source.html#l00026">findComplexRationalApproximation.m:26</a></div></div>
<div class="ttc" id="agenerate_p_r_r_file_8m_html_a45d9f8dad1bcc7195d94b27e4ab44377"><div class="ttname"><a href="generate_p_r_r_file_8m.html#a45d9f8dad1bcc7195d94b27e4ab44377">a</a></div><div class="ttdeci">Find a complex rational model for freq domain data for a</div><div class="ttdef"><b>Definition:</b> <a href="generate_p_r_r_file_8m_source.html#l00013">generatePRRFile.m:13</a></div></div>
<div class="ttc" id="agenerate_p_r_r_file_8m_html_a6f6ccfcf58b31cb6412107d9d5281426"><div class="ttname"><a href="generate_p_r_r_file_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></div><div class="ttdeci">for i</div><div class="ttdef"><b>Definition:</b> <a href="generate_p_r_r_file_8m_source.html#l00019">generatePRRFile.m:19</a></div></div>
<div class="ttc" id="aget_residues_8m_html_a0c8c4debc6d39f21547fca40c224adf5"><div class="ttname"><a href="get_residues_8m.html#a0c8c4debc6d39f21547fca40c224adf5">A</a></div><div class="ttdeci">To ensure residues come in perfect conjugate we form A as A</div><div class="ttdef"><b>Definition:</b> <a href="get_residues_8m_source.html#l00028">getResidues.m:28</a></div></div>
<div class="ttc" id="aget_residues_8m_html_a21ad0bd836b90d08f4cf640b4c298e7c"><div class="ttname"><a href="get_residues_8m.html#a21ad0bd836b90d08f4cf640b4c298e7c">b</a></div><div class="ttdeci">b</div><div class="ttdef"><b>Definition:</b> <a href="get_residues_8m_source.html#l00047">getResidues.m:47</a></div></div>
<div class="ttc" id="aget_residues_8m_html_aa67ca74f1a2f805ccd4f8460589ec897"><div class="ttname"><a href="get_residues_8m.html#aa67ca74f1a2f805ccd4f8460589ec897">x</a></div><div class="ttdeci">Obtain iteration resiudes for model x</div><div class="ttdef"><b>Definition:</b> <a href="get_residues_8m_source.html#l00050">getResidues.m:50</a></div></div>
<div class="ttc" id="aget_residues_8m_html_ad09d5e2b38260605147c2f55bdacc7db"><div class="ttname"><a href="get_residues_8m.html#ad09d5e2b38260605147c2f55bdacc7db">make</a></div><div class="ttdeci">Using these poles make(s-a) terms %Each row corresponds to a partial fraction model at one frequency Asys</div></div>
<div class="ttc" id="ainterch_8m_html_ae4e69912f5a2f923a187c235f950a7d2"><div class="ttname"><a href="interch_8m.html#ae4e69912f5a2f923a187c235f950a7d2">abs</a></div><div class="ttdeci">end if abs(real(dotprod))&gt;rstoerst rstoerst</div></div>
<div class="ttc" id="arot_8m_html_a08a8fae29827bd080fd336a8b6ba58c6"><div class="ttname"><a href="rot_8m.html#a08a8fae29827bd080fd336a8b6ba58c6">sum</a></div><div class="ttdeci">Square sum(error) of solution aaa=0.0</div></div>
<div class="ttc" id="arot_8m_html_ab0af012900d619eab5ab7f86d3280e1a"><div class="ttname"><a href="rot_8m.html#ab0af012900d619eab5ab7f86d3280e1a">scale</a></div><div class="ttdeci">Picking the solution(1, 2) with the smallest square sum else scale(col)</div></div>
<div class="ttc" id="atransistor_comparison_8m_html_ab17c3cef3d14df451e925a524b5d9106"><div class="ttname"><a href="transistor_comparison_8m.html#ab17c3cef3d14df451e925a524b5d9106">title</a></div><div class="ttdeci">title(&quot;S-Param input&quot;)</div></div>
<div class="ttc" id="atransistor_comparison_8m_html_ab2ef037fa1090e2d820de186fbabb641"><div class="ttname"><a href="transistor_comparison_8m.html#ab2ef037fa1090e2d820de186fbabb641">disp</a></div><div class="ttdeci">disp(&quot;done&quot;)</div></div>
<div class="ttc" id="avectfit3_8m_html_a1876b9e22fe9c18599690da850c0d3d8"><div class="ttname"><a href="vectfit3_8m.html#a1876b9e22fe9c18599690da850c0d3d8">skip_res</a></div><div class="ttdeci">Do NOT skip pole identification def skip_res</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00137">vectfit3.m:137</a></div></div>
<div class="ttc" id="avectfit3_8m_html_a1fa4192670bf44f6f0a620b55b725635"><div class="ttname"><a href="vectfit3_8m.html#a1fa4192670bf44f6f0a620b55b725635">spy2</a></div><div class="ttdeci">No plotting for first stage of vector fitting def spy2</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00140">vectfit3.m:140</a></div></div>
<div class="ttc" id="avectfit3_8m_html_a2d6365ba9c4986ccd25d2a6255aaa975"><div class="ttname"><a href="vectfit3_8m.html#a2d6365ba9c4986ccd25d2a6255aaa975">spy1</a></div><div class="ttdeci">Create complex state space model def spy1</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00139">vectfit3.m:139</a></div></div>
<div class="ttc" id="avectfit3_8m_html_a31d3c7f0c8dfb939c0a194673d1ab890"><div class="ttname"><a href="vectfit3_8m.html#a31d3c7f0c8dfb939c0a194673d1ab890">errplot</a></div><div class="ttdeci">Use logarithmic ordinate axis def errplot</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00143">vectfit3.m:143</a></div></div>
<div class="ttc" id="avectfit3_8m_html_a3a292ee37dd5b3d3e29181014ccabc01"><div class="ttname"><a href="vectfit3_8m.html#a3a292ee37dd5b3d3e29181014ccabc01">stable</a></div><div class="ttdeci">id stable()</div></div>
<div class="ttc" id="avectfit3_8m_html_a3c80bda0d42b16986a0eda3bbe56e85d"><div class="ttname"><a href="vectfit3_8m.html#a3c80bda0d42b16986a0eda3bbe56e85d">f</a></div><div class="ttdeci">Create magnitude plot for fitting of f(s) def.logx</div></div>
<div class="ttc" id="avectfit3_8m_html_a41272a6445be55e5b161a144120355b1"><div class="ttname"><a href="vectfit3_8m.html#a41272a6445be55e5b161a144120355b1">asymp</a></div><div class="ttdeci">Enforce stable poles def asymp</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00135">vectfit3.m:135</a></div></div>
<div class="ttc" id="avectfit3_8m_html_a48ae57de950f271dc9954e502333093a"><div class="ttname"><a href="vectfit3_8m.html#a48ae57de950f271dc9954e502333093a">angle</a></div><div class="ttdeci">exclude plot of phase angle(in addition to magnitiude) def.legend</div></div>
<div class="ttc" id="avectfit3_8m_html_a5d35b2657f4cd1c457b35c41a6d0075e"><div class="ttname"><a href="vectfit3_8m.html#a5d35b2657f4cd1c457b35c41a6d0075e">fitting</a></div><div class="ttdeci">Include only D in fitting(not E) def.skip_pole=0</div></div>
<div class="ttc" id="avectfit3_8m_html_a84e33b2b08c3f6fb24e0138872006707"><div class="ttname"><a href="vectfit3_8m.html#a84e33b2b08c3f6fb24e0138872006707">logy</a></div><div class="ttdeci">Use logarithmic abscissa axis def logy</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00142">vectfit3.m:142</a></div></div>
<div class="ttc" id="avectfit3_8m_html_ac0e19213c1ea9a512fea6f185c6f4573"><div class="ttname"><a href="vectfit3_8m.html#ac0e19213c1ea9a512fea6f185c6f4573">residues</a></div><div class="ttdeci">Do NOT skip identification of residues(C, D, E) def.cmplx_ss</div></div>
<div class="ttc" id="avectfit3_8m_html_ac31e858b1752c374e24ca249b311a362"><div class="ttname"><a href="vectfit3_8m.html#ac31e858b1752c374e24ca249b311a362">phaseplot</a></div><div class="ttdeci">Include deviation in magnitude plot def phaseplot</div><div class="ttdef"><b>Definition:</b> <a href="vectfit3_8m_source.html#l00144">vectfit3.m:144</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_8b2c91a1122d1f1764fea2c97c31c88b.html">Matlab</a></li><li class="navelem"><a class="el" href="vectfit3_8m.html">vectfit3.m</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
